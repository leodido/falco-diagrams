<!-- generated by mermaid compile action - START -->
![~mermaid diagram 1~](/output/input_1_2_scap_open_live_int-md-1.png)
<details>
  <summary>Mermaid markup</summary>

```mermaid
sequenceDiagram
    Note over scap_open_live_int(): !userspace
    scap_open_live_int()->>sysconf(): _SC_NPROCESSORS_ONLN, _SC_PHYS_PAGES, _SC_PAGESIZE
    scap_open_live_int()->>scap_create_iflist(): create interface list
    scap_create_iflist()-->>scap_open_live_int(): error status
    scap_open_live_int()->>scap_create_userlist(): create user list
    scap_create_userlist()-->>scap_open_live_int(): error status
    alt bpf == true
    scap_open_live_int()->>scap_bpf_load(): load eBPF probe
    Note over scap_bpf_load(): REF: SCAP BPF LOAD
    scap_bpf_load()-->>scap_open_live_int(): error status
    else kernel module
    Note over scap_open_live_int(): allocate the ring buffer
    Note over scap_open_live_int(): open the devices
    Note over scap_open_live_int(): map the ring buffer
    end
    scap_open_live_int()->>scap_proc_scan_proc_dir(): create process list
    scap_proc_scan_proc_dir()-->>scap_open_live_int(): error status
    scap_open_live_int()->>scap_start_capture(): start the capture
    scap_start_capture()-->>scap_open_live_int(): error status
```

</details>
<!-- generated by mermaid compile action - END -->
